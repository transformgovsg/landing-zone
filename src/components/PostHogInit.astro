<!-- prettier-ignore -->
<!-- TODO: figure out prettier issue for this file, remove from `.prettierignore` once resolved-->
---
import { loadPostHog } from '../utils/posthog-loader';

const posthogKey = process.env.PUBLIC_POSTHOG_KEY || import.meta.env.PUBLIC_POSTHOG_KEY;
const posthogHost =
  process.env.PUBLIC_POSTHOG_HOST ||
  import.meta.env.PUBLIC_POSTHOG_HOST ||
  'https://app.posthog.com';
const isDev = import.meta.env.DEV;
---

{
  posthogKey && (
    <>
      <script src={`${posthogHost}/static/array.js`} />
      <script is:inline define:vars={{ posthogKey, posthogHost, isDev }}>
        window.posthog = window.posthog || [];
        window.posthog.init(posthogKey, {
          api_host: posthogHost,
          loaded(posthog) {
            posthog.register({
              environment: isDev ? 'development' : 'production',
              host: window.location.host,
            });
            if (isDev) posthog.debug();
          },
          capture_pageview: false,
        });
      </script>
    </>
  )
}
